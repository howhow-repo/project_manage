<!-- [ Header ] start -->
<header class="navbar pcoded-header navbar-expand-lg navbar-light">
    <div class="m-header">
        <a class="mobile-menu" id="mobile-collapse1" href="javascript:"><span></span></a>
        <a href="/" class="b-brand">
            <img style="width:52px; height:52px"
                     src="{{ ASSETS_ROOT }}/images/logo-thumb.png" class="rounded-circle">
<!--            <div class="b-bg">-->
<!--                <i class="feather icon-trending-up"></i>-->
<!--            </div>-->
            <span class="b-title">Manual</span>
        </a>
    </div>
    <a class="mobile-menu" id="mobile-header" href="javascript:">
        <i class="feather icon-more-horizontal"></i>
    </a>
    <div class="collapse navbar-collapse">
        <ul class="navbar-nav mr-auto">
            <li><a href="javascript:" class="full-screen" onclick="javascript:toggleFullScreen()"><i
                    class="feather icon-maximize"></i></a>
            </li>
        </ul>
        <ul class="navbar-nav ml-auto">
            <li>
                <h6 id="nav-add-ticket-btn" class="nav-item" onclick="add_ticket()"><i class="feather icon-plus"></i>新增便簽</h6>
            </li>
            <li>
                <a href="{% url 'pre_add_customer' %}" class="nav-item"><i class="feather icon-plus"></i>電話新增</a>
            </li>
            <li>
                <a href="{% url 'add_customer' %}" class="nav-item"><i class="feather icon-plus"></i>客戶新增</a>
            </li>
            <li>
                <label>
                    <i class="icon feather icon-sun" id="theme-indicator"></i>
                    <input type="checkbox" id="theme-switch" class="d-none">
                </label>
            </li>
            <li>
                <div class="dropdown drp-user">
                    <a href="javascript:" class="dropdown-toggle" data-toggle="dropdown">
                        <i class="icon feather icon-settings"></i>
                    </a>
                    <div class="dropdown-menu dropdown-menu-right profile-notification">
                        <div class="pro-head">
                            <span>
                                {{ request.user.username }}
                            </span>
                            <a href="{% url 'logout' %}" class="dud-logout" title="Logout">
                                <i class="feather icon-log-out"></i>
                            </a>
                        </div>
                        <ul class="pro-body">
                            <li><a href="{% url 'logout' %}" class="dropdown-item">
                                <i class="feather icon-lock"></i> Logout</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </li>
        </ul>
    </div>
</header>
<!-- [ Header ] end -->
<script>
    const nav_currentHost = window.location.origin;

    function copyToClipboard(content) {
        var copyArea = document.createElement('textarea');
        copyArea.value = content;
        document.body.appendChild(copyArea);
        copyArea.select();
        copyArea.setSelectionRange(0, 99999); /* For mobile devices */
        document.execCommand('copy');
        document.body.removeChild(copyArea);
    }

    function add_ticket() {
        var xhr = new XMLHttpRequest();
        xhr.open('POST', '{% url "tickets-new_ticket" %}');
        xhr.setRequestHeader("Content-type", "application/json");
        xhr.setRequestHeader("Accept", "*/*");
        xhr.setRequestHeader('X-CSRFToken', '{{ csrf_token }}');
        xhr.onreadystatechange = function() {
            if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {
                var response = JSON.parse(this.responseText);
                var link = nav_currentHost + '/tickets/' + response.id + '/customer_update/';
                copyToClipboard(link);
                alert(link);
            }
        };
        xhr.send();
    }
</script>
